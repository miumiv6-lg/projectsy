<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Project SY In-Game</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<style>
/* CSS Variables & Reset (Matching index.css) */
:root {
    --color-background: #0e0e10;
    --color-surface: #18181b;
    --color-surface-hover: #2f2f35;
    --color-text-primary: #efeff1;
    --color-text-secondary: #adadb8;
    --color-primary: #1092ea; /* Updated Blue */
    --radius-md: 6px;
    --radius-lg: 8px;
    --radius-xl: 12px;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

html, body {
    width: 100%; height: 100%;
    overflow: hidden;
    background: transparent;
    color: var(--color-text-primary);
    font-family: 'Inter', -apple-system, sans-serif;
    -webkit-font-smoothing: antialiased;
    user-select: none;
}

/* Hide cursor initially */
body.cursor-hidden,
body.cursor-hidden * { 
    cursor: none !important; 
}

/* Background */
.bg-layer {
    position: fixed;
    inset: 0;
    z-index: 0;
    overflow: hidden;
    background-color: #000;
}
.bg-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0.6;
    transition: all 1.2s cubic-bezier(0.22, 1, 0.36, 1); /* Smooth cinematic transition */
    transform: scale(1);
}

/* Initial state (Click Screen) - Darker overlay handled by opacity */

/* Active state (Spawn Selection) - Zoom in + Blur + Darker */
body:not(.cursor-hidden) .bg-image {
    opacity: 0.4;
    filter: blur(10px) brightness(0.6);
    transform: scale(1.15);
}

.bg-overlay {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.2); /* Base tint */
    pointer-events: none;
}

/* Screens Container */
.screen {
    position: fixed;
    inset: 0;
    z-index: 10;
    display: none;
    align-items: center;
    justify-content: center;
}
.screen.active { display: flex; }

/* ===== CLICK TO START SCREEN ===== */
.click-container {
    text-align: center;
    cursor: pointer;
    transition: transform 0.2s ease;
}
.click-container:hover { transform: scale(1.02); }

.click-icon-box {
    width: 100px;
    height: 100px;
    background-color: var(--color-surface);
    border-radius: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 24px;
    box-shadow: 0 0 40px rgba(16, 146, 234, 0.2);
    border: 1px solid rgba(255,255,255,0.05);
    transition: all 0.3s ease;
}
.click-container:hover .click-icon-box {
    background-color: var(--color-primary);
    box-shadow: 0 0 60px rgba(16, 146, 234, 0.5);
    border-color: transparent;
}
.click-icon-box svg path { transition: fill 0.3s ease, stroke 0.3s ease; }
.click-container:hover .click-icon-box svg path { stroke: white; }
.click-container:hover .click-icon-box svg path[fill] { fill: white; }

.click-title {
    font-size: 48px;
    font-weight: 800;
    margin-bottom: 8px;
    letter-spacing: -1px;
    text-shadow: 0 4px 20px rgba(0,0,0,0.5);
}

.click-subtitle {
    display: inline-block;
    background-color: var(--color-surface);
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 13px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: var(--color-primary);
    border: 1px solid rgba(255,255,255,0.05);
}

/* ===== SPAWN SELECTION SCREEN ===== */
.spawn-card {
    width: 600px;
    max-width: 90%;
    background-color: var(--color-surface);
    border-radius: var(--radius-xl);
    box-shadow: 0 20px 50px rgba(0,0,0,0.5);
    padding: 32px;
    display: flex;
    flex-direction: column;
    max-height: 85vh;
    animation: slideUp 0.4s ease-out;
}

@keyframes slideUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.spawn-header {
    text-align: center;
    margin-bottom: 24px;
}
.spawn-title {
    font-size: 24px;
    font-weight: 800;
    margin-bottom: 8px;
}
.spawn-line {
    width: 40px;
    height: 4px;
    background-color: var(--color-primary);
    border-radius: 2px;
    margin: 0 auto;
}

/* Filter Tabs */
.tabs {
    display: flex;
    gap: 8px;
    background-color: #0e0e10; /* Darker bg for tabs */
    padding: 4px;
    border-radius: var(--radius-lg);
    margin-bottom: 20px;
}
.tab {
    flex: 1;
    padding: 10px;
    border: none;
    background: transparent;
    color: var(--color-text-secondary);
    font-family: inherit;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    border-radius: 6px;
    transition: all 0.2s;
}
.tab:hover { color: var(--color-text-primary); background-color: rgba(255,255,255,0.05); }
.tab.active {
    background-color: var(--color-primary);
    color: white;
    box-shadow: 0 2px 8px rgba(16, 146, 234, 0.3);
}

/* Spawn List */
.spawn-list {
    flex: 1;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 8px;
    padding-right: 4px;
}
/* Scrollbar */
.spawn-list::-webkit-scrollbar { width: 6px; }
.spawn-list::-webkit-scrollbar-track { background: transparent; }
.spawn-list::-webkit-scrollbar-thumb { background: #3f3f46; border-radius: 3px; }

.spawn-btn {
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 16px;
    background-color: var(--color-surface-hover);
    border: 1px solid transparent;
    border-radius: var(--radius-lg);
    cursor: pointer;
    text-align: left;
    transition: all 0.2s;
    color: inherit;
}
.spawn-btn:hover {
    background-color: #3f3f46;
    border-color: rgba(255,255,255,0.1);
    transform: translateX(4px);
}

.spawn-icon {
    width: 40px;
    height: 40px;
    background-color: rgba(0,0,0,0.2);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    color: var(--color-text-secondary);
}
.spawn-btn:hover .spawn-icon {
    background-color: var(--color-primary);
    color: white;
}

.spawn-info { flex: 1; }
.spawn-name { font-size: 15px; font-weight: 700; color: var(--color-text-primary); margin-bottom: 2px; }
.spawn-desc { font-size: 12px; color: var(--color-text-secondary); }
.spawn-arrow { color: var(--color-text-secondary); opacity: 0; transition: opacity 0.2s; }
.spawn-btn:hover .spawn-arrow { opacity: 1; }

/* ===== HUD ELEMENTS (Clock, Stats, Logo) ===== */
.hud-element {
    position: fixed;
    z-index: 20;
    pointer-events: none; /* Let clicks pass through */
    opacity: 0;
    transition: opacity 0.5s;
}
body.spawn-mode .hud-element { opacity: 1; }

#top-logo { top: 32px; left: 32px; display: flex; gap: 16px; align-items: center; }
#top-logo img { width: 48px; height: 48px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); }
#top-logo .text h1 { font-size: 18px; font-weight: 800; line-height: 1; margin-bottom: 4px; }
#top-logo .text p { font-size: 11px; font-weight: 700; text-transform: uppercase; color: var(--color-primary); letter-spacing: 1px; }

#stats-panel { top: 32px; right: 32px; display: flex; gap: 12px; }
.stat-box {
    background-color: rgba(0,0,0,0.6);
    backdrop-filter: blur(4px);
    padding: 8px 12px;
    border-radius: 8px;
    font-size: 13px;
    font-weight: 600;
    color: var(--color-text-secondary);
    border: 1px solid rgba(255,255,255,0.05);
}
.stat-val { color: white; font-weight: 700; margin-left: 6px; }
.stat-ping { color: #22c55e; }

#clock-panel { bottom: 32px; right: 32px; text-align: right; }
#clock-time { font-size: 48px; font-weight: 200; letter-spacing: -2px; line-height: 1; }
#clock-date { font-size: 13px; font-weight: 600; color: var(--color-text-secondary); text-transform: uppercase; letter-spacing: 1px; margin-top: 4px; }

</style>
</head>
<body class="menu-active cursor-hidden"> <!-- Start with menu active and cursor HIDDEN -->

    <!-- Background Image -->
    <div class="bg-layer">
        <img src="https://i.ibb.co/sdFN8VZh/generated-image.jpg" class="bg-image" alt="Background">
        <div class="bg-overlay"></div>
    </div>

    <!-- HUD Elements (Visible after spawn) -->
    <div id="top-logo" class="hud-element">
        <img src="https://i.ibb.co/Xf2nNn4H/photo-2025-12-03-19-30-54.jpg" alt="Logo">
        <div class="text">
            <h1>Project SY</h1>
            <p>Metrostroi NoRank</p>
        </div>
    </div>

    <div id="stats-panel" class="hud-element">
        <div class="stat-box">Ping <span id="ping" class="stat-val stat-ping">24 ms</span></div>
        <div class="stat-box">FPS <span id="fps" class="stat-val">120</span></div>
    </div>

    <div id="clock-panel" class="hud-element">
        <div id="clock-time">00:00</div>
        <div id="clock-date">1 ЯНВАРЯ 2025</div>
    </div>

    <!-- SCREENS -->
    
    <!-- 1. CLICK TO START -->
    <div class="screen active" id="scr-click">
        <div class="click-container" onclick="goToSpawnSelect()">
            <div class="click-icon-box">
                <!-- Mouse Icon -->
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="6" y="3" width="12" height="18" rx="6" stroke="#53535f" stroke-width="2"/>
                    <path d="M12 3V9" stroke="#53535f" stroke-width="2"/>
                    <path d="M6 9H18" stroke="#53535f" stroke-width="2"/>
                    <path d="M6 9C6 5.68629 8.68629 3 12 3V9H6Z" fill="#53535f"/>
                </svg>
            </div>
            <h1 class="click-title">Нажмите ЛКМ</h1>
            <div class="click-subtitle">Чтобы начать игру</div>
        </div>
    </div>

    <!-- 2. SPAWN SELECTION -->
    <div class="screen" id="scr-spawn">
        <div class="spawn-card">
            <div class="spawn-header">
                <div class="spawn-title">Выберите точку спавна</div>
                <div class="spawn-line"></div>
            </div>

            <div class="tabs">
                <button class="tab active" onclick="filterSpawns('all', this)">Все точки</button>
                <button class="tab" onclick="filterSpawns('driver', this)">Машинист</button>
                <button class="tab" onclick="filterSpawns('passenger', this)">Пассажир</button>
            </div>

            <div class="spawn-list" id="spawnList">
                <!-- Items injected by JS -->
            </div>
        </div>
    </div>

<script>
    // Config
    const SPAWNS = [
        { id: 'depot', type: 'driver', title: 'ТЧ-1 «Лихоборы»', desc: 'Электродепо. Спавн составов.', icon: 'url(https://img.icons8.com/fluency/96/train.png)' },
        { id: 'tupik', type: 'driver', title: 'Тупик ст. Физтех', desc: 'Оборотный тупик. Смена кабины.', icon: 'url(https://img.icons8.com/fluency/96/sorting-arrows-horizontal.png)' },
        { id: 'lianozovo', type: 'passenger', title: 'Ст. Лианозово', desc: 'Пассажирская платформа', icon: 'url(https://img.icons8.com/fluency/96/map-pin.png)' },
        { id: 'fiztech', type: 'passenger', title: 'Ст. Физтех', desc: 'Конечная станция', icon: 'url(https://img.icons8.com/fluency/96/map-pin.png)' },
        { id: 'yahroma', type: 'passenger', title: 'Ст. Яхромская', desc: 'Пассажирская платформа', icon: 'url(https://img.icons8.com/fluency/96/map-pin.png)' }
    ];

    // Functions
    function goToSpawnSelect() {
        // Called from Lua or onClick
        document.body.classList.remove('cursor-hidden'); 
        document.getElementById('scr-click').classList.remove('active');
        document.getElementById('scr-spawn').classList.add('active');
        playMusic();
    }

    function spawnPlayer(id) {
        // GMod Bridge
        if (typeof gmod !== 'undefined' && gmod.spawn) {
            gmod.spawn(id);
        } else {
            console.log('Spawning at:', id);
        }
        
        // Hide UI
        document.body.classList.remove('menu-active');
        document.body.classList.add('spawn-mode');
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    }

    function filterSpawns(type, btn) {
        // Update Tabs
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        btn.classList.add('active');

        // Render List
        const list = document.getElementById('spawnList');
        list.innerHTML = '';

        SPAWNS.filter(s => type === 'all' || s.type === type).forEach(s => {
            const el = document.createElement('button');
            el.className = 'spawn-btn';
            el.onclick = () => spawnPlayer(s.id);
            el.innerHTML = `
                <div class="spawn-icon" style="background-image: ${s.icon}; background-size: 24px; background-repeat: no-repeat; background-position: center;"></div>
                <div class="spawn-info">
                    <div class="spawn-name">${s.title}</div>
                    <div class="spawn-desc">${s.desc}</div>
                </div>
                <div class="spawn-arrow">➜</div>
            `;
            list.appendChild(el);
        });
    }

    // Init
    filterSpawns('all', document.querySelector('.tab.active'));

    // Clock
    function updateClock() {
        const d = new Date();
        document.getElementById('clock-time').textContent = d.toLocaleTimeString('ru-RU', {hour:'2-digit', minute:'2-digit'});
        document.getElementById('clock-date').textContent = d.toLocaleDateString('ru-RU', {day:'numeric', month:'long', year:'numeric'});
    }
    setInterval(updateClock, 1000);
    updateClock();

    // Fake Stats
    setInterval(() => {
        document.getElementById('fps').textContent = Math.floor(60 + Math.random() * 60);
        document.getElementById('ping').textContent = Math.floor(15 + Math.random() * 30) + ' ms';
    }, 1000);

    // Audio
    const audio = new Audio();
    audio.loop = true; // Loop music
    
    function playMusic() {
        // Direct link to file in repo or external URL
        audio.src = 'music/apart.mp3'; // Using local relative path
        audio.volume = 0.3;
        audio.play().catch(e => console.log('Audio autoplay blocked:', e));
    }

</script>
</body>
</html>
